# CitiBike Markov Model Configuration
# =====================================

# Data paths
data:
  trip_data_dir: "data"
  station_info_path: "data/stations/station_info.csv"
  inventory_dir: "data/inventory"
  output_dir: "outputs"
  # Parquet/DuckDB settings
  use_parquet: true  # If true, load from Parquet; otherwise use CSV
  parquet_dir: "data/parquet/trips"  # Path to Parquet files

# Time range for analysis
time:
  # Date format: YYYY-MM-DD
  start_date: "2025-05-01"
  end_date: "2025-10-31"

# Cross-validation settings
cross_validation:
  # Rolling window parameters
  train_weeks: 3
  test_weeks: 1
  increment_days: 1  # Roll forward by 1 day (default: 7 days = test_weeks)
  # Minimum number of folds to run
  min_folds: 3

# Station filtering
stations:
  # Minimum trips to include a station
  min_trips: 100
  # NYC bounding box for coordinate filtering
  lat_min: 40.4
  lat_max: 41.0
  lng_min: -74.3
  lng_max: -73.6

# Empty/Full thresholds (as fraction of capacity)
thresholds:
  empty: 0.1   # < 10% of capacity = empty
  full: 0.9    # > 90% of capacity = full

# Model settings
model:
  # Which model to use:
  #   - "persistence": Inventory stays constant (simplest baseline)
  #   - "station_avg": Station-only average (no temporal patterns)
  #   - "temporal_flow": Time-conditioned flow (hour + weekend)
  #   - "markov": Markov chain with transition matrices
  name: "temporal_flow"
  
  # Temporal flow model parameters
  temporal_flow:
    description: "Predicts inventory using time-conditioned historical flow"
  
  # Markov model parameters
  markov:
    smoothing_alpha: 0.0
    min_transitions: 10
    n_simulations: 1  # Single random walk (no MC averaging)
    random_seed: 42   # Set to null for non-reproducible runs

# Evaluation settings
evaluation:
  # Time frequency for predictions
  freq: "1h"
  
  # Metrics computed:
  # - inventory_mae: Mean Absolute Error on bike counts
  # - inventory_rmse: Root Mean Squared Error
  # - empty_recall/precision/f1: For empty station prediction
  # - full_recall/precision/f1: For full station prediction
  # - state_accuracy: Overall % correct state predictions

# Logging
logging:
  level: "INFO"
  save_predictions: true
